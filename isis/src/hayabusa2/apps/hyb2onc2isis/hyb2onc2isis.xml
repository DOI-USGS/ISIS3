<?xml version="1.0" encoding="UTF-8"?>
<application name="hyb2onc2isis" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:noNamespaceSchemaLocation="http://isis.astrogeology.usgs.gov/Schemas/Application/application.xsd">

  <brief>Import FITS formatted Hayabusa2 images into the ISIS cube format</brief>

  <description>
    <p>
       This application will import and convert a Hayabusa2 Optical Navigation Camera (ONC)
       FIT image to an ISIS cube.
      
    </p>
    <br/>
    <h3>Requirements</h3>
    <ul>
      <li>
        Raw image data file (.fit) (specified in <em>FROM</em> label)
      </li>
      <li>
        Output ISIS file name (.cub) (specified in <em>TO</em> label)
      </li>
      <li>
        Target name if target must be overridden (specified in <em>TARGET</em>). 
      </li>
    </ul>
    <p>
       The input FITS formatted header file for the Hayabusa2
       image must be used in the FROM parameter.  
    </p>
    <h3>When TARGET Parameter Should Be Specified</h3>
    <ul>
      <li>
        When Hayabusa2 EDR labels contain an incorrect value for the 
      TARGET_NAME keyword 
      </li>
      <li>
         To define TARGET = "SKY" to later project the data with 
        <em>skymap</em>.
      </li>
    </ul>
    <br/>
    <h2>Mission Overview</h2>
    <p>
       The Hayabusa2 spacecraft was launched on 3 Dec 2014.  The Optical Navigation Camera (ONC) 
       package is positioned on the nadir-facing panel.
    </p>
    <p>
       The mission purpose is to rendezvous with (and provide a sample return from) 
       the Apollo asteroid 162173 Ryugu, a Cg-type asteroid. 
    </p> 
    <h2>Instrument Overview</h2>
    <p>
       The ONC package consists of three cameras: the telescopic (ONC-T) camera and two wide-angle 
       cameras (ONC-W1,ONC-W2).
    </p>

    <p>
       The ONC package has a set of eight bandpass filters. Below is a table of 
       the filters and their specifications:
    </p>
    <br/>


    <br/>
    <h2>Data Archive</h2>
    <p>
       ???
    </p>
    
    <br/>
    <h2>References</h2>
    <br/>
    <cite>
      Suzuki, H. et al. (2017) Initial Inflight Calibration for Hayabusa2 Optical
      Navigation Camera (ONC) for Scientific Observations of Asteroid Ryugu (in review for Icarus).
    </cite>
    <br/>
    <br/>
    <cite>
        Kameda, S. et al. (2015) Detectability of hydrous minerals using ONC-T camera onboard
        the Hayabusa2 spacecraft, Advances in Space Research, Volume 56, Issue 7, Pages 1519-1524,
        ISSN 0273-1177, http://dx.doi.org/10.1016/j.asr.2015.06.037.
        (http://www.sciencedirect.com/science/article/pii/S0273117715004743)
    </cite>
    <br/>
    <br/>

  </description>

  <history>
    <change name="Kaj Williams" date="2017-07-05">
      Original version
    </change>
    <change name="Kaj Williams and Ian Humphrey" date="2017-07-26">
      Added references and more text.
    </change>
    <change name="Tyler Wilson" date="2018-11-30">
      Updated the ingestion routine to handle new keywords, and retain the ability to
      process FIT files using the old keywords.  Also set TARGET=RYUGU in the event the user
      does not specify a target, and the target in the fit label is set to SKY.
    </change>
    <change name="Kaitlyn Lee" date="2020-07-21">
      Updated calibration method to match JAXAs calibration by:
      1. moving linearity correction to after smear correction,
      2. commenting out dark current and linearity correction,
      3. changing an addition to subtraction in the g_bias calculation,
      4. refactoring the smear correction to be before the main loop to speed up the program
         and to be dependent on the bit-corrected input image DNs instead of the already corrected
         output image DNs,
      5. and removing `*g_sensitivity*g_texp` in the flat-field correction so that the output
         aligns with l2b data.
    </change>
  </history>

  <category>
    <missionItem>Hayabusa2</missionItem> 
  </category> 

  <groups>
    <group name="Files">
      <parameter name="FROM">
        <type>filename</type>
        <fileMode>input</fileMode>
        <brief>
          Input fit file for ONC image.
        </brief>
        <description>
           The program, <em>hyb2onc2isis</em>, will read the FIT file and extract
           the header contained therein.  Some FIT label values are transferred
           to the output ISIS files as well for completeness.
        </description>      
        <filter>*.fit</filter>
      </parameter>
      
      <parameter name="TO">
         <type>cube</type>
         <fileMode>output</fileMode>
         <brief>Output ISIS3 cube filename</brief>
         <description>
           Use this parameter to select the output filename of the ISIS cube 
           generated by this application.
         </description>
         <filter>*.cub</filter>
       </parameter>

    </group>
    <group name="Parameters">
        <parameter name="TARGET">
            <type>string</type>
            <brief>Provide target name if absent or incorrect in input (FROM) 
              label 
            </brief>
            <description>
              <p>
                 This parameter may be necessary as some ONC EDR labels may 
                 not contain correct values for the TARGET_NAME keyword. This 
                 parameter can be used to provide the correct name of the target.  
                 It may also be used to specify SKY as the target to support 
                 projecting data to the celestial sphere. 
              </p>
            </description>
            <internalDefault>SKY</internalDefault>
        </parameter>
    </group>
  </groups>
</application>
